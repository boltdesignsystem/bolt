/* ------------------------------------ *\
   Table
\* ------------------------------------ */

@import '@bolt/core-v3.x';

// see https://github.com/datorama/themify#known-issues for more info on why the border styles need to be written out longhand
$bolt-table-border-width: 1px;
$bolt-table-border-style: solid;
$bolt-table-border-color: var(--m-bolt-disabled);
$bolt-table-header-background-color: rgba(bolt-color(gray), 0.1);
$bolt-table-row-hover-background-color: rgba(bolt-color(gray), 0.1);

@mixin bolt-table-border($direction) {
  border-#{$direction}-color: $bolt-table-border-color;
  border-#{$direction}-style: $bolt-table-border-style;
  border-#{$direction}-width: $bolt-table-border-width;
}

.e-bolt-table-wrapper {
  @include bolt-horizontal-scroll;
  display: block;
  max-width: 100%;
  background: -webkit-radial-gradient(
        left,
        ellipse,
        var(--m-bolt-border) 0%,
        transparent 75%
      )
      0 center,
    -webkit-radial-gradient(
        right,
        ellipse,
        var(--m-bolt-border) 0%,
        transparent 75%
      ) 100% center;
  background-attachment: scroll, scroll;
  background-color: var(--m-bolt-bg);
  background-repeat: no-repeat;
  background-size: 0.5em 100%, 0.5em 100%;
}

caption {
  caption-side: bottom;
  font-size: var(--bolt-type-font-size-xsmall);
  line-height: var(--bolt-type-line-height-xsmall);
  text-align: left;
}

.e-bolt-table {
  @include bolt-table-border(right);
  @include bolt-table-border(bottom);
  @include bolt-table-border(left);

  width: 100%;
  max-width: 100%;
  border-collapse: collapse;
  border-spacing: 0;

  thead,
  tbody,
  tfoot {
    background: linear-gradient(
      to right,
      var(--m-bolt-bg) 0.5em,
      transparent 0.5em,
      transparent calc(100% - 0.5em),
      var(--m-bolt-bg) calc(100% - 0.5em)
    );
  }

  tbody,
  tfoot {
    tr:hover {
      background-color: $bolt-table-row-hover-background-color;
    }
  }

  tfoot {
    td,
    th {
      font-weight: var(--bolt-type-font-weight-bold);
    }
  }

  tr {
    @include bolt-table-border(top);
    transition: background-color var(--bolt-transition);
  }

  td,
  th {
    font-family: var(--bolt-type-font-family-body);
    font-size: var(--bolt-type-font-size-small);
    font-weight: var(--bolt-type-font-weight-regular);
    color: var(--m-bolt-text);
    line-height: var(--bolt-type-line-height-small);

    &:not(:last-child) {
      @include bolt-table-border(right);
    }
  }

  th,
  thead td,
  tfoot td {
    padding: var(--bolt-spacing-y-small) var(--bolt-spacing-x-small);
  }

  td {
    text-align: left;
    vertical-align: top;

    img {
      max-width: 100%;
    }
  }

  th {
    font-family: var(--bolt-type-font-family-headline);
    font-size: var(--bolt-type-font-size-small);
    font-weight: var(--bolt-type-font-weight-semibold);
    color: var(--m-bolt-headline);
    line-height: var(--bolt-type-line-height-small);
    background-color: $bolt-table-header-background-color;
    white-space: nowrap;
  }

  &.e-bolt-table--borderless {
    td:not(:last-child),
    th:not(:last-child) {
      border-right: 0;
    }

    tbody th:not(:last-child) {
      @include bolt-table-border(right);
    }
  }

  &.e-bolt-table--numeric {
    td,
    th {
      font-family: var(--bolt-type-font-family-code);
      text-align: center;
      white-space: nowrap;
    }

    tbody th,
    tfoot th {
      width: 1%;
      text-align: right;
    }

    tbody th {
      font-family: var(--bolt-type-font-family-body);
    }
  }

  &.e-bolt-table--fixed-width-columns {
    &--first {
      tr th:first-of-type,
      tr td:first-of-type {
        width: 1%;
        white-space: nowrap;
      }

      &.e-bolt-table--side-headers {
        thead tr th:nth-of-type(1),
        tbody tr td:nth-of-type(1),
        tfoot tr td:nth-of-type(1) {
          width: auto;
          white-space: normal;
        }
      }
    }

    &--second {
      tr th:first-of-type + th,
      tr th:first-of-type + td,
      tr td:first-of-type + td,
      tr td:first-of-type + th {
        width: 1%;
        white-space: nowrap;
      }

      &.e-bolt-table--side-headers {
        thead tr th:nth-of-type(2),
        tbody tr td:nth-of-type(2),
        tfoot tr td:nth-of-type(2) {
          width: auto;
          white-space: normal;
        }
      }
    }

    &--first-two {
      tr th:first-of-type,
      tr td:first-of-type {
        width: 1%;
        white-space: nowrap;
      }

      tr th:first-of-type + th,
      tr th:first-of-type + td,
      tr td:first-of-type + td {
        width: 1%;
        white-space: nowrap;
      }

      &.e-bolt-table--side-headers {
        thead tr th:nth-of-type(2),
        tbody tr td:nth-of-type(2),
        tfoot tr td:nth-of-type(2) {
          width: auto;
          white-space: normal;
        }
      }
    }
  }

  &.e-bolt-table--fixed-width-table {
    table-layout: fixed;

    tr th,
    tr td,
    tr th:first-of-type,
    tr td:first-of-type,
    tr th:first-of-type + th,
    tr th:first-of-type + td,
    tr td:first-of-type + td,
    tr td:first-of-type + th {
      width: auto;
      white-space: normal;
      word-break: break-all;
    }
  }
}
// A workaround to have horizontally scrolable table when nested inside bolt-layout
.l-bolt-site > main {
  min-width: 0;
}
