{% if enable_json_schema_validation %}
  {{ validate_data_schema(bolt.data.components['@bolt-components-device-viewer'].schema, _self) | raw }}
{% endif %}

{% set colors = [
  "silver",
  "black",
  "gold"
] %}

{% set orientations = [
  "portrait",
  "landscape"
] %}

{% set prefix = "c-bolt-" %}
{% set deviceName = device | default("ipad") %}
{% set color = color | default("black") %}
{% set orientation = orientation | default("portrait") %}

{# DEPRECATED.  Support for magnify will be dropped in a future release. #}
{% set magnify = magnify | default(false) %}

{% set attributes = create_attribute(attributes|default({})) %}

{# Defaults for a vanilla `Button` component #}
{% set componentName = deviceName ~ "-viewer" %}
{% set baseClass = prefix ~ componentName %}

{% if image and magnify == true %}
  {% set image = image | merge({
    zoom: true
  }) %}
{% endif %}

{# DEPRECATED.  Don't use the `image` prop, use the `content` prop to pass a rendered image instead. #}
{% if image %}
  {% set content %}
    {% if image.src %}
      {% set _image_attributes = image.attributes|default({}) %}
      {% set _image_attributes = _image_attributes|merge({
        src: image.src,
        alt: image.alt,
        srcset: image.srcset,
        sizes: image.sizes,
      }) %}

      {% if image.lazyload == true %}
        {% set _image_attributes = _image_attributes|merge({loading: 'lazy'}) %}
      {% endif %}

      {% if no_lazy == true %}
        {% set _image_attributes = _image_attributes|merge({loading: 'eager'}) %}
      {% endif %}

      {% if image.max_width %}
        {% set _image_attributes = _image_attributes|merge({
          style: 'max-width: ' ~ image.max_width ~ ';'
        }) %}
      {% endif %}

      {% set _image_props = { attributes: _image_attributes } %}

      {% if image.max_width %}
        {% set _image_props = _image_props|merge({fill: true}) %}
      {% endif %}

      {% if image.cover %}
        {% set _image_props = _image_props|merge({background: true}) %}
      {% endif %}
    {% else %}
      {% set _image_props = image %}
    {% endif %}

    {% include "@bolt-elements-image/image.twig" with _image_props only %}
  {% endset %}
{% endif %}

{% set classes = [
  baseClass,
  "c-bolt-device-viewer",
  "marvel-device",
  color in colors ? baseClass ~ "--" ~ color : "",
  orientation in orientations ? baseClass ~ "--" ~ orientation : ""
] %}


<bolt-device-viewer {{ attributes.addClass(classes | raw) }}>
  <div class="c-bolt-device-viewer__inner {{ baseClass ~ "__inner"}}">
    <div class="{{ baseClass ~ "__top-bar"}}"></div>
    <div class="{{ baseClass ~ "__bottom-bar"}}"></div>
    <div class="{{ baseClass ~ "__sensor"}}"></div>
    <div class="{{ baseClass ~ "__sleep"}}"></div>
    <div class="{{ baseClass ~ "__volume"}}"></div>
    <div class="c-bolt-device-viewer__camera {{ baseClass ~ "__camera"}}"></div>
    <div class="{{ baseClass ~ "__speaker"}}"></div>
    <div class="c-bolt-device-viewer__home {{ baseClass ~ "__home"}}"></div>

    <div class="c-bolt-device-viewer__screen {{ baseClass ~ "__screen"}}">
      {% if magnify %}<bolt-image-zoom>{% endif %}
        {% if magnify %}
          {% include "@bolt/_screen-tilt.twig" %}
        {% endif %}

        {# DEPRECATED.  Don't use the twig block, just use the `content` prop instead. #}
        {% block device_viewer_image %}
          {% if content %}
            {{ content }}
          {% endif %}
        {% endblock %}

        {% if magnify %}
          <div class="c-bolt-image-zoom__overlay">
            {% include "@bolt/icon.twig" with {
              name: "search",
              size: "xlarge",
              background: "circle",
              attributes: {
                class: [
                  "c-bolt-image-zoom__overlay-icon"
                ]
              }
            } only %}
          </div>
        {% endif %}
      {% if magnify %}</bolt-image-zoom>{% endif %}
    </div>
  </div>
</bolt-device-viewer>
