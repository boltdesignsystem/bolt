/* ------------------------------------ *\
   Responsive Table
\* ------------------------------------ */

@import '@bolt/core-v3.x';

// Register Custom Block Element
@include bolt-custom-element('bolt-responsive-table', block, medium);

/**
 * Long-form comment.
 *
 * This spans multiple lines and is also constrained to no longer than 80
 * characters in width.
 *
 * 1. Provide line-comments like this.
 */

.c-bolt-responsive-table {
  @include bolt-horizontal-scroll;

  display: inline-block;
  max-width: 100%;
  max-height: 75vh;
  border-radius: bolt-border-radius(small);
  box-shadow: 0 0 0 1px var(--m-bolt-disabled);
  background-color: var(--m-bolt-disabled);

  @media print {
    max-width: none;
    max-height: none;
  }

  &.c-bolt-responsive-table--borderless {
    box-shadow: none;
  }
}

.c-bolt-responsive-table__table {
  .c-bolt-responsive-table--borderless & {
    border-spacing: 0;
  }
}

.c-bolt-responsive-table__head {
  --m-bolt-link: var(--m-bolt-headline);

  .c-bolt-responsive-table__header {
    position: sticky;
    top: 0;
    z-index: 1;
    box-shadow: 0 0 0 1px var(--m-bolt-disabled);

    .c-bolt-responsive-table--borderless & {
      box-shadow: none;
    }

    @media print {
      position: static;
      top: unset;
      z-index: auto;
    }

    .c-bolt-inline-label--checkbox {
      color: var(--m-bolt-headline);
    }
  }
}

.c-bolt-responsive-table__body,
.c-bolt-responsive-table__footer {
  .c-bolt-responsive-table__header {
    position: sticky;
    left: 0;
    z-index: 2;
    box-shadow: 0 0 0 1px var(--m-bolt-disabled);

    .c-bolt-responsive-table--borderless & {
      box-shadow: none;
    }

    @media print {
      position: static;
      top: unset;
      z-index: auto;
    }
  }
}

.c-bolt-responsive-table__row {
  &[id^='hidden-row'] {
    .c-bolt-responsive-table__cell {
      &:nth-of-type(1),
      &:nth-of-type(2) {
        position: sticky;
        left: 0;
        z-index: 2;
        box-shadow: 0 0 0 1px var(--m-bolt-disabled);

        .c-bolt-responsive-table--borderless & {
          box-shadow: none;
        }

        @media print {
          position: static;
          top: unset;
          z-index: auto;
        }
      }

      &:nth-of-type(2) {
        left: 37px;
      }
    }
  }

  &[id^='hidden-row'] {
    @media print {
      display: table-row !important;
    }
  }
}

.c-bolt-responsive-table__row:not([id^='hidden-row']) {
  .c-bolt-responsive-table__header {
    &:nth-of-type(2) {
      left: 37px;
    }
    @media print {
      position: static;
      top: unset;
      z-index: auto;
    }
  }
}

.c-bolt-responsive-table__button--expand {
  position: relative;

  &:before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: calc(100% + 2 * var(--bolt-spacing-x-small));
    height: calc(100% + 2 * var(--bolt-spacing-y-small));
  }

  &[aria-expanded='true'] {
    svg {
      transform: rotate(180deg);
    }
  }
}

.c-bolt-responsive-table__cell {
  background-color: var(--m-bolt-bg);
}

.c-bolt-responsive-table__head .c-bolt-responsive-table__cell,
.c-bolt-responsive-table__header {
  background-color: var(--m-bolt-table-header);

  &:first-child {
    border-top-left-radius: bolt-border-radius(small);
  }

  &:last-child {
    border-top-right-radius: bolt-border-radius(small);
  }
}

.c-bolt-responsive-table__footer .c-bolt-responsive-table__cell,
.c-bolt-responsive-table__footer .c-bolt-responsive-table__header {
  &:first-child {
    border-bottom-left-radius: bolt-border-radius(small);
  }

  &:last-child {
    border-bottom-right-radius: bolt-border-radius(small);
  }
}

.c-bolt-responsive-table__header,
.c-bolt-responsive-table__cell {
  position: relative;
  padding: var(--bolt-spacing-y-small) var(--bolt-spacing-x-small);
  transition: background-color var(--bolt-transition);
}

.c-bolt-responsive-table__footer {
  .c-bolt-responsive-table__header,
  .c-bolt-responsive-table__cell {
    font-weight: var(--bolt-type-font-weight-bold);
  }
}

.c-bolt-responsive-table__caption {
  padding: var(--bolt-spacing-y-small) var(--bolt-spacing-x-small);
  font-size: var(--bolt-type-font-size-xsmall);
  line-height: var(--bolt-type-line-height-xsmall);
  text-align: center;
  background-color: transparent;
  caption-side: bottom;
}

.c-bolt-responsive-table__body,
.c-bolt-responsive-table__footer {
  .c-bolt-responsive-table__row:hover {
    .c-bolt-responsive-table__header,
    .c-bolt-responsive-table__cell {
      background-color: var(--m-bolt-table-header);
    }
  }
}

.c-bolt-responsive-table__button {
  @include bolt-button-native-styles-reset;

  &:focus {
    outline: var(--bolt-focus-ring);
    outline-offset: 6px;
  }
}

.c-bolt-responsive-table__controls {
  display: flex;
  justify-content: space-between;
  gap: var(--bolt-spacing-x-small);
  align-items: center;

  .c-bolt-responsive-table__button {
    display: flex;
    color: var(--m-bolt-headline);
  }
}

///// old filters
.c-bolt-responsive-table__filters {
  @include bolt-shadow(
    $key: 'level-20',
    $base-color: var(--bolt-color-navy-light)
  );
  display: none;
  position: absolute;
  overflow-x: hidden;
  right: 0;
  z-index: bolt-z-index(popover);
  max-height: 8rem;
  padding: var(--bolt-spacing-y-small) var(--bolt-spacing-x-small);
  border-radius: bolt-border-radius(small);
  background-color: var(--bolt-color-white);

  &--visible {
    display: block;
  }
}

.c-bolt-responsive-table__filters-list {
  margin: 0;
  list-style-type: none;
}

.c-bolt-responsive-table__filters-item {
  margin-bottom: var(--bolt-spacing-y-xsmall);
}

.c-bolt-responsive-table__filters-label {
  &:hover {
    cursor: pointer;
  }
}

.c-bolt-responsive-table__filters-checkbox {
  margin-right: var(--bolt-spacing-x-small);
}

.c-bolt-responsive-table__filters-reset {
  @include bolt-shadow(
    $key: 'level-20',
    $base-color: var(--bolt-color-navy-light)
  );
  display: none;
  padding: var(--bolt-spacing-y-xxsmall) var(--bolt-spacing-x-xxsmall);
  background-color: var(--bolt-color-gray-xlight);
}

.c-bolt-responsive-table__filters-reset--visible {
  display: block;
}

.c-bolt-responsive-table__header-cta {
  display: flex;
  justify-content: space-between;
}

/////old collapsing rows
.c-bolt-responsive-table__button--toggle-row {
  display: flex;
  justify-content: flex-end;
  align-items: center;

  &:before {
    content: '';
    opacity: 0;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }

  &:focus {
    position: absolute;
    top: 0;
    left: 0;
    z-index: 9999;
    width: 100%;
    height: 100%;
    outline: var(--bolt-focus-ring);
    outline-offset: -6px;

    .c-bolt-responsive-table__trigger-icon {
      margin-right: var(--bolt-spacing-x-small);
    }
  }

  &[aria-expanded='true'] {
    .c-bolt-responsive-table__trigger-icon {
      transform: rotate(180deg);
    }
  }
}

.c-bolt-responsive-table__row--hidden {
  display: none;

  @media print {
    display: block;
  }
}
