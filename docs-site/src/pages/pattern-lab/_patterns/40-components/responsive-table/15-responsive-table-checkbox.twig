{% set description %}
  In use cases where checkboxes are necessary in a table, render the checkbox in the first cell of a row.
{% endset %}

{% set notes %}
  <bolt-ol>
    <bolt-li>For the first cell of each row, use a header cell instead of a regular cell. This gives a visual cue that ticking the checkbox would select the entire row.</bolt-li>
    <bolt-li>Additional JavaScript is needed for checkbox behaviors and functions.</bolt-li>
  </bolt-ol>
{% endset %}

{% set demo %}
  {% set header %}
    {% set checkbox %}
      {% set label %}
        {% include '@bolt-components-form/form-label.twig' with {
          title: 'Build',
          displayType: 'inline-checkbox',
          attributes: {
            for: 'checkbox-header',
            name: 'checkbox-name'
          },
        } only %}
      {% endset %}
      {% set input %}
        {% include '@bolt-components-form/form-input.twig' with {
          attributes: {
            type: 'checkbox',
            id: 'checkbox-header',
            class: [
              'js-bolt-head-checkbox'
            ]
          },
        } only %}
      {% endset %}
      {% include '@bolt-components-form/form-element.twig' with {
        label: label,
        children: input,
      } only %}
    {% endset %}
    {% set cells %}
      {% include '@bolt-components-responsive-table/table-cell.twig' with {
        content: checkbox,
        header: true,
      } only %}
      {% include '@bolt-components-responsive-table/table-cell.twig' with {
        content: 'Item number',
        header: true,
      } only %}
      {% include '@bolt-components-responsive-table/table-cell.twig' with {
        content: 'Description',
        header: true,
      } only %}
      {% include '@bolt-components-responsive-table/table-cell.twig' with {
        content: 'Assemblies',
        header: true,
      } only %}
    {% endset %}
    {% include '@bolt-components-responsive-table/table-row.twig' with {
      content: cells,
    } only %}
  {% endset %}

  {% set row1 %}
    {% set checkbox %}
      {% set label %}
        {% include '@bolt-components-form/form-label.twig' with {
          title: 'Build 2.0.1.0 — SR-49969',
          displayType: 'inline-checkbox',
          attributes: {
            for: 'checkbox-row-1',
            name: 'checkbox-name'
          },
        } only %}
      {% endset %}
      {% set input %}
        {% include '@bolt-components-form/form-input.twig' with {
          attributes: {
            type: 'checkbox',
            id: 'checkbox-row-1',
            class: [
              'js-bolt-body-row-checkbox'
            ]
          },
        } only %}
      {% endset %}
      {% include '@bolt-components-form/form-element.twig' with {
        label: label,
        children: input,
      } only %}
    {% endset %}
    {% set cells %}
      {% include '@bolt-components-responsive-table/table-cell.twig' with {
        content: checkbox,
        header: true,
      } only %}
      {% include '@bolt-components-responsive-table/table-cell.twig' with {
        content: 'SR-49941',
      } only %}
      {% include '@bolt-components-responsive-table/table-cell.twig' with {
        content: 'This hotfix changes Updater requirements for .NET. If you are using Updater with 7.1 or 8.0 Robotic Automation Runtime clients, you now need to have both .NET 4.0 and .NET 3.5 installed.',
      } only %}
      {% set files %}
        OpenSpan.UpdaterService.Remoting.dll<br>
        OpenSpan.Updater.ServerClientInterface.dll<br>
        OpenSpan.Updater.ScheduledTasks.dll<br>
        OpenSpan.Updater.PrePostOperation.dll<br>
        OpenSpan.Updater.Git.dll<br>
        OpenSpan.VersionFinder.exe<br>
        OpenSpan.UpdaterService.exe<br>
        OpenSpan.Updater.X509tool.exe<br>
        OpenSpan.Updater.UserHelper.exe<br>
        OpenSpan.Updater.UninstallHelper.exe<br>
        OpenSpan.Updater.RuntimeLauncher.exe<br>
        OpenSpan.Updater.InstallHelper.exe<br>
        OpenSpan.Updater.Initializer.exe
      {% endset %}
      {% include '@bolt-components-responsive-table/table-cell.twig' with {
        content: files,
      } only %}
    {% endset %}
    {% include '@bolt-components-responsive-table/table-row.twig' with {
      content: cells,
    } only %}
  {% endset %}

  {% set row2 %}
    {% set checkbox %}
      {% set label %}
        {% include '@bolt-components-form/form-label.twig' with {
          title: 'Build 1.1.360 — SR-44891',
          displayType: 'inline-checkbox',
          attributes: {
            for: 'checkbox-row-2',
            name: 'checkbox-name'
          },
        } only %}
      {% endset %}
      {% set input %}
        {% include '@bolt-components-form/form-input.twig' with {
          attributes: {
            type: 'checkbox',
            id: 'checkbox-row-2',
            class: [
              'js-bolt-body-row-checkbox'
            ]
          },
        } only %}
      {% endset %}
      {% include '@bolt-components-form/form-element.twig' with {
        label: label,
        children: input,
      } only %}
    {% endset %}
    {% set cells %}
      {% include '@bolt-components-responsive-table/table-cell.twig' with {
        content: checkbox,
        header: true,
      } only %}
      {% include '@bolt-components-responsive-table/table-cell.twig' with {
        content: 'SR-44869',
      } only %}
      {% include '@bolt-components-responsive-table/table-cell.twig' with {
        content: 'This hotfix changes the system to better handle long file names. It also enhances VersionFinder to sort the list of branches, making it easier to find a specific branch.',
      } only %}
      {% include '@bolt-components-responsive-table/table-cell.twig' with {
        content: 'OpenSpan.Updater.Git.dll',
      } only %}
    {% endset %}
    {% include '@bolt-components-responsive-table/table-row.twig' with {
      content: cells,
    } only %}
  {% endset %}

  {% set row3 %}
    {% set checkbox %}
      {% set label %}
        {% include '@bolt-components-form/form-label.twig' with {
          title: 'Build 1.1.354 — SR-44889',
          displayType: 'inline-checkbox',
          attributes: {
            for: 'checkbox-row-3',
            name: 'checkbox-name'
          },
        } only %}
      {% endset %}
      {% set input %}
        {% include '@bolt-components-form/form-input.twig' with {
          attributes: {
            type: 'checkbox',
            id: 'checkbox-row-3',
            class: [
              'js-bolt-body-row-checkbox'
            ]
          },
        } only %}
      {% endset %}
      {% include '@bolt-components-form/form-element.twig' with {
        label: label,
        children: input,
      } only %}
    {% endset %}
    {% set cells %}
      {% include '@bolt-components-responsive-table/table-cell.twig' with {
        content: checkbox,
        header: true,
      } only %}
      {% include '@bolt-components-responsive-table/table-cell.twig' with {
        content: 'SR-44850',
      } only %}
      {% include '@bolt-components-responsive-table/table-cell.twig' with {
        content: 'This hotfix changes Updater to avoid an exception that could prevent it from correctly populating branches.',
      } only %}
      {% include '@bolt-components-responsive-table/table-cell.twig' with {
        content: 'ManagedOpenSsl.dll',
      } only %}
    {% endset %}
    {% include '@bolt-components-responsive-table/table-row.twig' with {
      content: cells,
    } only %}
  {% endset %}

  {% include '@bolt-components-responsive-table/table.twig' with {
    header: {
      content: header,
    },
    body: {
      content: [
        row1,
        row2,
        row3,
      ],
      attributes: {},
    },
    attributes: {
      class: [
        'c-bolt-responsive-table--sticky-side-headers'
      ]
    },
  } only %}
{% endset %}

{% set twig_markup %}{% verbatim %}
{% endverbatim %}{% endset %}

{% set demo_js %}
<script>
  function toggleCheckbox() {
    const mainCheckbox = document.querySelector(
      '.js-bolt-head-checkbox',
    );

    const rowCheckboxes = document.querySelectorAll(
      '.js-bolt-body-row-checkbox',
    );
    rowCheckboxes.forEach(el => {
      el.addEventListener('click', () => {
        mainCheckbox.checked = true;
        let allUnchecked = [...rowCheckboxes].every(e => !e.checked);
        if (allUnchecked) {
          mainCheckbox.checked = false;
        }
      });
    });

    function checkAllCheckboxes() {
      rowCheckboxes.forEach(el => {
        if (el.checked) {
          el.checked = false;
        } else {
          el.checked = true;
        }
      });

      if (!mainCheckbox.checked) {
        rowCheckboxes.forEach(el => {
          el.checked = false;
        });
      }
    }

    if (mainCheckbox) {
      mainCheckbox.addEventListener('click', checkAllCheckboxes);
    }
  }
  toggleCheckbox()
</script>
{% endset %}

{% include '@utils/pattern-doc-page.twig' with {
  title: 'Table Checkboxes',
  description: description,
  notes: notes,
  demo: demo,
  twig_markup: twig_markup,
  js: demo_js,
} only %}

{{ demo_js }}
